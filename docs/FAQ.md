# System Architecture of MorningAI

MorningAI employs a robust, scalable architecture designed to facilitate autonomous code generation, documentation management, and multi-platform integration. This comprehensive guide aims to provide developers with a clear understanding of the platform's system architecture, enabling efficient usage and customization.

## Overview

The MorningAI platform is built on a microservices architecture, leveraging a combination of modern technologies and frameworks to ensure high performance, reliability, and scalability. The key components of this architecture include:

- **Frontend**: Developed using React, Vite, and TailwindCSS for a responsive and modern user interface.
- **Backend**: Powered by Python with Flask framework and Gunicorn for handling multiple worker processes efficiently.
- **Database**: Utilizes PostgreSQL for data storage, enhanced with Row Level Security (RLS) for data protection. Supabase is used as the Database as a Service (DBaaS) provider.
- **Queue System**: Implements Redis Queue (RQ) to manage background jobs and real-time task orchestration.
- **Orchestration**: Uses LangGraph for defining and executing agent workflows in an autonomous agent system.
- **AI Integration**: Incorporates OpenAI GPT-4 for generating content dynamically.
- **Deployment**: Hosted on Render.com with Continuous Integration/Continuous Deployment (CI/CD) pipelines to streamline updates.

### Frontend Architecture

```jsx
// src/App.jsx
import React from 'react';
import { BrowserRouter as Router, Route, Switch } from 'react-router-dom';
import HomePage from './pages/HomePage';
import DocumentationPage from './pages/DocumentationPage';

function App() {
  return (
    <Router>
      <Switch>
        <Route path="/" exact component={HomePage} />
        <Route path="/docs" component={DocumentationPage} />
      </Switch>
    </Router>
  );
}

export default App;
```

This snippet showcases the routing setup within the React application, directing users between the home page and documentation page.

### Backend Architecture

```python
# app.py
from flask import Flask
from werkzeug.middleware.proxy_fix import ProxyFix

app = Flask(__name__)
app.wsgi_app = ProxyFix(app.wsgi_app)

if __name__ == "__main__":
    app.run()
```

Here we have a basic Flask application setup that's ready to be integrated with other components like database connections and RESTful API endpoints.

### Database Configuration

To configure PostgreSQL with Row Level Security in Supabase:

1. Navigate to your Supabase project dashboard.
2. Open the SQL Editor from the sidebar.
3. Execute SQL statements to enable RLS policies on your desired tables.

```sql
CREATE POLICY "UserIsOwner" ON public.your_table_name
FOR ALL USING (auth.uid() = user_id);
```

This SQL policy ensures that only the owner of a record can access it, leveraging Supabase's built-in `auth.uid()` function for user identification.

### Queue Management with Redis Queue

```python
# worker.py
import os
from redis import Redis
from rq import Worker, Queue, Connection

listen = ['default']

redis_url = os.getenv('REDISTOGO_URL', 'redis://localhost:6379')

if __name__ == '__main__':
    with Connection(Redis.from_url(redis_url)):
        worker = Worker(map(Queue, listen))
        worker.work()
```

This script sets up a worker process that listens to jobs posted on the default queue in Redis Queue.

### Troubleshooting Tips

- **Frontend Issues**: Ensure all dependencies are correctly installed via `npm install` or `yarn install`. Check browser console for errors.
- **Backend Connectivity**: Verify that environment variables for database connections are correctly set. Use Flask debug mode to trace issues.
- **Database RLS Policies**: If facing access control issues, review your RLS policies in Supabase to ensure they match your application logic.
- **Redis Queue Jobs Stuck**: Check that worker processes are running and able to connect to your Redis instance. Use Redis CLI tools or dashboard to monitor job status.

For more detailed documentation on each component:
- React: [https://reactjs.org/docs/getting-started.html](https://reactjs.org/docs/getting-started.html)
- Flask: [https://flask.palletsprojects.com/en/2.0.x/](https://flask.palletsprojects.com/en/2.0.x/)
- PostgreSQL & Supabase: [https://supabase.io/docs](https://supabase.io/docs)
- Redis Queue: [http://python-rq.org/docs/](http://python-rq.org/docs/)
- Render Deployment: [https://render.com/docs](https://render.com/docs)

---
Generated by MorningAI Orchestrator using GPT-4

---

**Metadata**:
- Task: What is the system architecture?
- Trace ID: `c8eea8d6-76ab-4317-84b6-2970563b23e6`
- Generated by: MorningAI Orchestrator using gpt-4-turbo-preview
- Repository: RC918/morningai
